function runGame(){"use strict";const t=13;var e,o,n,r,s,a,i,d,u=0,c=0,p={iResolution:-1,cam:-1,tpos:-1,tscl:-1,ptpos:-1,tut:-1},l={dir:0,pos:{x:3,z:-10},tpos:{x:0,z:-2,t:0},ptpos:{x:0,z:0},tsgot:0,ksDwn:new Set([]),tutAnim:1};function m(t){return l.ksDwn.has(t)}function f(t,e){return Math.sqrt(t*t+e*e)}function w(e){l.tsgot>0&&l.tutAnim>0&&(l.tutAnim-=e/4),l.tpos.t<1&&(l.tpos.t+=e/8);var o=0;if((m("arrowup")||m("w"))&&(o+=2),(m("arrowdown")||m("s"))&&(o-=1.5),(m("arrowleft")||m("a"))&&(l.dir-=e),(m("arrowright")||m("d"))&&(l.dir+=e),m("shift")&&(o*=2),0!=o){const t=function(t,e,o){const n=Math.sin(o),r=Math.cos(o);return{x:r*t+n*e,z:r*e-n*t}}(0,o*e,l.dir);l.pos.x+=t.x,l.pos.z+=t.z}const n=l.pos.x-l.tpos.x,s=l.pos.z-l.tpos.z;f(n,s)<3.5&&(l.ptpos.x=l.tpos.x,l.ptpos.z=l.tpos.z,l.tpos.x=60*(.5-Math.random()),l.tpos.z=60*(.5-Math.random()),l.tpos.t=0,l.tsgot+=1,null!=d&&(d.innerHTML=l.tsgot.toString())),f(n,s)>70&&f(l.pos.x-l.ptpos.x,l.pos.z-l.ptpos.z)>70&&(l.tsgot=t+1,r.classList.add("open"))}if(n=document.getElementById("start"),r=document.getElementById("lose"),s=document.getElementById("win"),n.classList.remove("open"),e=document.getElementById("game"),null===(o=e.getContext("webgl"))||void 0===o)return void alert("Unable to initialize WebGL. Your browser or computer may not support it.");function g(t,e){const n=o.createShader(e);if(o.shaderSource(n,t),o.compileShader(n),!o.getShaderParameter(n,o.COMPILE_STATUS)){throw"WebGL compile shdr fail.\n\n"+o.getShaderInfoLog(n)}return n}o.clearColor(.4,0,0,1),o.clear(o.COLOR_BUFFER_BIT);const h=o.createProgram();if(o.attachShader(h,g("\nprecision lowp float;\nattribute vec2 vCoord;\nvoid main(){\ngl_Position=vec4(vCoord,0.,1.);\n}",o.VERTEX_SHADER)),o.attachShader(h,g(fs,o.FRAGMENT_SHADER)),o.linkProgram(h),o.validateProgram(h),!o.getProgramParameter(h,o.LINK_STATUS))throw"WebGL compile pg fail.\n\n"+o.getProgramInfoLog(h);o.useProgram(h);const v=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,v),o.bufferData(o.ARRAY_BUFFER,new Float32Array([-1,1,-1,-1,1,-1,1,-1,1,1,-1,1]),o.STATIC_DRAW);const E=o.getAttribLocation(h,"vCoord");if(E<0)throw"vertexAttribPointer not found";o.enableVertexAttribArray(E),o.vertexAttribPointer(E,2,o.FLOAT,!1,0,0),Object.keys(p).forEach(t=>{const e=o.getUniformLocation(h,t);if(p[t]=e,null===e||e<0)throw t+" uloc not found! "+o.getError()}),o.viewport(0,0,e.width,e.height),window.requestAnimationFrame(function n(r){const a=(r-c)/1e3;u%60==0&&console.log("FPS: "+(1/a).toString().substring(0,5)),w(a),o.uniform2f(p.iResolution,e.width,e.height);const i=Math.sin(l.dir),d=Math.cos(l.dir),m=[d,-i,0,i,d,0,l.pos.x,l.pos.z,0];o.uniformMatrix3fv(p.cam,!1,m),o.uniform2f(p.tpos,l.tpos.x,l.tpos.z),o.uniform2f(p.ptpos,l.ptpos.x,l.ptpos.z),o.uniform1f(p.tscl,(1-l.tsgot/(8*t))*l.tpos.t),o.uniform1f(p.tut,l.tutAnim),o.drawArrays(o.TRIANGLES,0,6),l.tsgot<t?requestAnimationFrame(n):s.classList.add("open"),c=r,u+=1});const L=new Set(["arrowup","arrowdown","arrowleft","arrowright","w","a","s","d","shift"]);function A(t){return(t=t||window.event).preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0,t.returnValue=!1,!1}function x(t){return e=>{A(e),l.ksDwn.add(t)}}function S(t){return e=>{A(e),l.ksDwn.delete(t)}}function b(t,e){t.addEventListener("touchstart",x(e)),t.addEventListener("mousedown",x(e)),t.addEventListener("touchend",S(e)),t.addEventListener("mouseup",S(e)),t.addEventListener("mouseout",S(e)),t.addEventListener("mouseleave",S(e)),t.addEventListener("touchcancel",S(e)),t.addEventListener("mousemove",A)}window.addEventListener("keydown",t=>{const e=t.key.toLowerCase();L.has(e)&&l.ksDwn.add(e)}),window.addEventListener("keyup",t=>{const e=t.key.toLowerCase();L.has(e)&&l.ksDwn.delete(e)}),null!=(a=document.getElementById("left"))&&b(a,"arrowleft"),null!=(i=document.getElementById("right"))&&b(i,"arrowright"),b(document.body,"arrowup"),null!=(d=document.getElementById("counter"))&&(d.innerHTML=(0).toString())}