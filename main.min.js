function runGame(){"use strict";const t=13;var o,e,n,r,s,a,i,d,u=0,c=0,l={iResolution:-1,cam:-1,tpos:-1,tscl:-1,ptpos:-1,tut:-1},p={dir:0,pos:{x:3,z:0},tpos:{x:5,z:10},ptpos:{x:0,z:0},tsgot:0,ksDwn:new Set([])};function f(t){return p.ksDwn.has(t)}function m(t,o){return Math.sqrt(t*t+o*o)}function g(o){var e=0;if((f("arrowup")||f("w"))&&(e+=2),(f("arrowdown")||f("s"))&&(e-=1.5),(f("arrowleft")||f("a"))&&(p.dir-=o),(f("arrowright")||f("d"))&&(p.dir+=o),f("shift")&&(e*=2),0!=e){const t=function(t,o,e){const n=Math.sin(e),r=Math.cos(e);return{x:r*t+n*o,z:r*o-n*t}}(0,e*o,p.dir);p.pos.x+=t.x,p.pos.z+=t.z}const n=p.pos.x-p.tpos.x,s=p.pos.z-p.tpos.z;m(n,s)<3.5&&(p.ptpos.x=p.tpos.x,p.ptpos.z=p.tpos.z,p.tpos.x=100*(.5-Math.random()),p.tpos.z=100*(.5-Math.random()),p.tsgot+=1,null!=d&&(d.innerHTML=p.tsgot.toString())),m(n,s)>50&&m(p.pos.x-p.ptpos.x,p.pos.z-p.ptpos.z)>50&&(console.log(p.tpos),console.log(p.ptpos),p.tsgot=t+1,r.classList.add("open"))}if(n=document.getElementById("start"),r=document.getElementById("lose"),s=document.getElementById("win"),n.classList.remove("open"),o=document.getElementById("game"),null===(e=o.getContext("webgl"))||void 0===e)return void alert("Unable to initialize WebGL. Your browser or computer may not support it.");function w(t,o){const n=e.createShader(o);if(e.shaderSource(n,t),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS)){throw"WebGL compile shdr fail.\n\n"+e.getShaderInfoLog(n)}return n}e.clearColor(.4,0,0,1),e.clear(e.COLOR_BUFFER_BIT);const h=e.createProgram();if(e.attachShader(h,w("\nprecision lowp float;\nattribute vec2 vCoord;\nvoid main(){\ngl_Position=vec4(vCoord,0.,1.);\n}",e.VERTEX_SHADER)),e.attachShader(h,w(fs,e.FRAGMENT_SHADER)),e.linkProgram(h),e.validateProgram(h),!e.getProgramParameter(h,e.LINK_STATUS))throw"WebGL compile pg fail.\n\n"+e.getProgramInfoLog(h);e.useProgram(h);const v=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,v),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,1,-1,-1,1,-1,1,-1,1,1,-1,1]),e.STATIC_DRAW);const E=e.getAttribLocation(h,"vCoord");if(E<0)throw"vertexAttribPointer not found";e.enableVertexAttribArray(E),e.vertexAttribPointer(E,2,e.FLOAT,!1,0,0),Object.keys(l).forEach(t=>{const o=e.getUniformLocation(h,t);if(l[t]=o,null===o||o<0)throw t+" uloc not found! "+e.getError()}),e.viewport(0,0,o.width,o.height),window.requestAnimationFrame(function n(r){const a=(r-c)/1e3;u%60==0&&console.log("FPS: "+(1/a).toString().substring(0,5)),g(a),e.uniform2f(l.iResolution,o.width,o.height);const i=Math.sin(p.dir),d=Math.cos(p.dir),f=[d,-i,0,i,d,0,p.pos.x,p.pos.z,0];e.uniformMatrix3fv(l.cam,!1,f),e.uniform2f(l.tpos,p.tpos.x,p.tpos.z),e.uniform2f(l.ptpos,p.ptpos.x,p.ptpos.z),e.uniform1f(l.tscl,1-p.tsgot/(8*t)),e.uniform1f(l.tut,p.tsgot>0?0:1),e.drawArrays(e.TRIANGLES,0,6),p.tsgot<t?requestAnimationFrame(n):s.classList.add("open"),c=r,u+=1});const L=new Set(["arrowup","arrowdown","arrowleft","arrowright","w","a","s","d","shift"]);function A(t){return(t=t||window.event).preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0,t.returnValue=!1,!1}function x(t){return o=>{A(o),p.ksDwn.add(t)}}function S(t){return o=>{A(o),p.ksDwn.delete(t)}}function b(t,o){t.addEventListener("touchstart",x(o)),t.addEventListener("mousedown",x(o)),t.addEventListener("touchend",S(o)),t.addEventListener("mouseup",S(o)),t.addEventListener("mouseout",S(o)),t.addEventListener("mouseleave",S(o)),t.addEventListener("touchcancel",S(o)),t.addEventListener("mousemove",A)}window.addEventListener("keydown",t=>{const o=t.key.toLowerCase();L.has(o)&&p.ksDwn.add(o)}),window.addEventListener("keyup",t=>{const o=t.key.toLowerCase();L.has(o)&&p.ksDwn.delete(o)}),null!=(a=document.getElementById("left"))&&b(a,"arrowleft"),null!=(i=document.getElementById("right"))&&b(i,"arrowright"),b(o,"arrowup"),null!=(d=document.getElementById("counter"))&&(d.innerHTML=(0).toString())}