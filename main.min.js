function runGame(){"use strict";const t=13;var o,e,n,r,s,a,i,d=0,u=0,c={iResolution:-1,cam:-1,tpos:-1,tscl:-1,ptpos:-1,tut:-1},p={dir:0,pos:{x:3,z:0},tpos:{x:5,z:10},ptpos:{x:0,z:0},tsgot:0,ksDwn:new Set([])};function l(t){return p.ksDwn.has(t)}function f(t,o){return Math.sqrt(t*t+o*o)}function m(o){var e=0;if((l("arrowup")||l("w"))&&(e+=2),(l("arrowdown")||l("s"))&&(e-=1.5),(l("arrowleft")||l("a"))&&(p.dir-=o),(l("arrowright")||l("d"))&&(p.dir+=o),l("shift")&&(e*=2),0!=e){const t=function(t,o,e){const n=Math.sin(e),r=Math.cos(e);return{x:r*t+n*o,z:r*o-n*t}}(0,e*o,p.dir);p.pos.x+=t.x,p.pos.z+=t.z}const n=p.pos.x-p.tpos.x,s=p.pos.z-p.tpos.z;f(n,s)<3.5&&(p.ptpos.x=p.tpos.x,p.ptpos.z=p.tpos.z,p.tpos.x=100*(.5-Math.random()),p.tpos.z=100*(.5-Math.random()),p.tsgot+=1),f(n,s)>50&&f(p.pos.x-p.ptpos.x,p.pos.z-p.ptpos.z)>50&&(console.log(p.tpos),console.log(p.ptpos),p.tsgot=t+1,r.classList.add("open"))}if(n=document.getElementById("start"),r=document.getElementById("lose"),s=document.getElementById("win"),n.classList.remove("open"),o=document.getElementById("game"),null===(e=o.getContext("webgl"))||void 0===e)return void alert("Unable to initialize WebGL. Your browser or computer may not support it.");function w(t,o){const n=e.createShader(o);if(e.shaderSource(n,t),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS)){throw"WebGL compile shdr fail.\n\n"+e.getShaderInfoLog(n)}return n}e.clearColor(.4,0,0,1),e.clear(e.COLOR_BUFFER_BIT);const g=e.createProgram();if(e.attachShader(g,w("\nprecision lowp float;\nattribute vec2 vCoord;\nvoid main(){\ngl_Position=vec4(vCoord,0.,1.);\n}",e.VERTEX_SHADER)),e.attachShader(g,w(fs,e.FRAGMENT_SHADER)),e.linkProgram(g),e.validateProgram(g),!e.getProgramParameter(g,e.LINK_STATUS))throw"WebGL compile pg fail.\n\n"+e.getProgramInfoLog(g);e.useProgram(g);const h=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,h),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,1,-1,-1,1,-1,1,-1,1,1,-1,1]),e.STATIC_DRAW);const v=e.getAttribLocation(g,"vCoord");if(v<0)throw"vertexAttribPointer not found";e.enableVertexAttribArray(v),e.vertexAttribPointer(v,2,e.FLOAT,!1,0,0),Object.keys(c).forEach(t=>{const o=e.getUniformLocation(g,t);if(c[t]=o,null===o||o<0)throw t+" uloc not found! "+e.getError()}),e.viewport(0,0,o.width,o.height),window.requestAnimationFrame(function n(r){const a=(r-u)/1e3;d%60==0&&console.log("FPS: "+(1/a).toString().substring(0,5)),m(a),e.uniform2f(c.iResolution,o.width,o.height);const i=Math.sin(p.dir),l=Math.cos(p.dir),f=[l,-i,0,i,l,0,p.pos.x,p.pos.z,0];e.uniformMatrix3fv(c.cam,!1,f),e.uniform2f(c.tpos,p.tpos.x,p.tpos.z),e.uniform2f(c.ptpos,p.ptpos.x,p.ptpos.z),e.uniform1f(c.tscl,1-p.tsgot/(8*t)),e.uniform1f(c.tut,p.tsgot>0?0:1),e.drawArrays(e.TRIANGLES,0,6),p.tsgot<t?requestAnimationFrame(n):s.classList.add("open"),u=r,d+=1});const E=new Set(["arrowup","arrowdown","arrowleft","arrowright","w","a","s","d","shift"]);function L(t){return(t=t||window.event).preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0,t.returnValue=!1,!1}function A(t){return o=>{L(o),p.ksDwn.add(t)}}function x(t){return o=>{L(o),p.ksDwn.delete(t)}}function S(t,o){t.addEventListener("touchstart",A(o)),t.addEventListener("mousedown",A(o)),t.addEventListener("touchend",x(o)),t.addEventListener("mouseup",x(o)),t.addEventListener("mouseout",x(o)),t.addEventListener("mouseleave",x(o)),t.addEventListener("touchcancel",x(o)),t.addEventListener("mousemove",L)}window.addEventListener("keydown",t=>{const o=t.key.toLowerCase();E.has(o)&&p.ksDwn.add(o)}),window.addEventListener("keyup",t=>{const o=t.key.toLowerCase();E.has(o)&&p.ksDwn.delete(o)}),null!=(a=document.getElementById("left"))&&S(a,"arrowleft"),null!=(i=document.getElementById("right"))&&S(i,"arrowright"),S(o,"arrowup")}